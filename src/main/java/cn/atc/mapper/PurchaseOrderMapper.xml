<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper SYSTEM "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.atc.mapper.PurchaseOrderMapper">

	<!-- 采购订单表的resultMap -->
	<resultMap type="PurchaseOrder" id="purchaseOrder">
		<id column="id" property="id" />
		<result column="purchaseTime" property="purchaseTime" />
		<result column="isSignin" property="isSignin" />
		<result column="notPassDesc" property="notPassDesc" />
		<result column="auditTime" property="auditTime" />
		<association property="buyerEmp" javaType="Employee">
			<id property="id" column="buyerId" />
			<result column="buyerName" property="name" />
		</association>
		<association property="consigneeEmp" javaType="Employee">
			<id property="id" column="consigneeId" />
			<result column="consigneeName" property="name" />
		</association>
		<association property="auditorEmp" javaType="Employee">
			<id property="id" column="auditorId" />
			<result column="auditorName" property="name" />
		</association>
		<association property="auditState" javaType="AuditState">
			<id property="id" column="auditstateId" />
			<result column="auditStateName" property="auditStateName" />
		</association>
	</resultMap>
	
	<select id="getPurchaseOrdersByCondition" parameterType="map"
		resultMap="purchaseOrder">
		SELECT p.*,
		e1.`id` AS 'buyerId',e1.`name` AS 'buyerName',
		e2.`id` AS 'auditorId',e2.`name` AS 'auditorName',
		e3.`id` AS
		'consigneeId',e3.`name` AS 'consigneeName',
		a.`id` AS
		'auditstateId',a.`auditStateName`
		FROM purchaseorder p
		INNER JOIN
		employee e1 ON p.`buyer`=e1.`id`
		INNER JOIN employee e2 ON
		p.`auditor`=e2.`id`
		INNER JOIN employee e3 ON p.`consignee`=e3.`id`
		INNER JOIN auditstate a ON p.`auditStateId`=a.`id`
	</select>

</mapper>
